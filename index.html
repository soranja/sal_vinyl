<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vinyl_icon.svg" />
    <link rel="stylesheet" href="./style.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Soranja Records</title>
  </head>

  <body>
    <div
      id="app"
      class="relative flex flex-col lg:flex-row w-full h-[var(--app-height)] max-h-[var(--app-height)] bg-[url(/bg-tile-gray.png)] bg-repeat bg-[length:100px_100px] text-white overflow-hidden"
    >
      <div id="vignette" class="hidden lg:block absolute inset-0 pointer-events-none bg-side-vingette z-1"></div>
      <div
        id="ready-area-background"
        class="absolute pointer-events-none bg-no-repeat bg-center bg-cover opacity-10 w-full h-full"
      ></div>

      <!-- INIT AREA -->
      <div
        id="init-area"
        class="w-[100vw] h-[calc(var(--app-height)_*_0.15)] md:h-[calc(var(--app-height)_*_0.25)] top-0 left-0 flex flex-row relative lg:w-[23vh] lg:h-screen items-center justify-start z-50"
      >
        <div id="init-area-threshold" class="flex flex-col justify-center items-start w-full h-full">
          <div
            id="record-list"
            class="w-[100vw] top-0 left-0 flex flex-row justify-center items-center gap-x-2 relative lg:w-[22vh] h-full lg:flex-col bg-yellow-500"
          >
            <!-- Records are here (via JS) -->
          </div>
        </div>
      </div>

      <!-- READY AREA -->
      <div
        id="ready-area"
        class="relative flex flex-col justify-center items-center lg:items-end w-full h-[calc(100%-10%)] lg:h-[var(--app-height)]"
      >
        <div
          id="ready-area-threshold"
          class="flex flex-col lg:flex-row justify-center lg:justify-start items-center w-auto lg:w-11/12 h-full"
        >
          <!-- Vinyl Player -->
          <div id="player-wrapper" class="flex px-6 py-10 w-full">
            <div id="player-container">
              <img
                id="player"
                src="/player/player.png"
                alt="player"
                class="relative w-auto h-[calc(var(--app-height)_*_0.6)] max-w-full select-none object-contain drop-shadow-[0_4px_6px_rgba(0,0,0,0.6)]"
              />
            </div>
            <div id="needle-container">
              <img
                id="needle"
                src="/player/needle.png"
                alt="needle"
                class="relative w-auto h-[calc(var(--app-height)_*_0.6)] max-w-full select-none object-contain drop-shadow-[0_4px_8px_rgba(0,0,0,0.6)] hidden lg:block"
              />
            </div>
          </div>
          <div
            id="record-info-wrapper"
            class="lg:w-full lg:h-[calc(var(--app-height)_*_0.6)] lg:flex flex-col grow-0 items-start justify-center"
          >
            <div id="record-info" class="flex flex-col gap-y-8 items-start justify-center">
              <div
                id="record-title"
                class="hidden font-bold absolute w-full left-0 text-3xl lg:static lg:text-4xl lg:w-auto ml-3 lg:ml-0"
              >
                ...
              </div>
              <div id="record-description" class="hidden text-base text-justify italic bg-black/50 p-8 lg:w-2/3">
                ...
              </div>
            </div>
          </div>
        </div>

        <!-- Player Controls -->
        <div id="player-ui" class="flex justify-center items-start gap-x-4 bg-yellow-500 p-6 w-full">
          <button id="play-button" class="p-3 bg-[#333] cursor-pointer flex items-center justify-center z-1">
            <img id="play-icon" src="/ui/play.svg" alt="play" class="w-6 h-6" />
          </button>
          <div
            id="progress-n-volume-wrapper"
            class="flex flex-col-reverse lg:flex-col items-start justify-between lg:justify-center w-full h-full lg:h-auto"
          >
            <div
              id="progress-bar-wrapper"
              class="w-full h-[calc(var(--app-height)*_0.021)] lg:h-[calc(var(--app-height)_*_0.013)] bg-[#555] relative overflow-hidden shadow-inners mb-[1.5px] lg:mb-0"
            >
              <div id="progress-bar-fill" class="absolute left-0 top-0 h-full bg-black w-0"></div>
              <div
                id="progress-pointer-wrapper"
                class="absolute w-[20px] h-[20px] lg:w-[12px] lg:h-[12px] top-1/2 -translate-x-1/4 -translate-y-1/2 z-20 flex items-center justify-center"
              >
                <div
                  id="progress-bar-pointer"
                  class="w-full h-full bg-white border-2 border-black pointer-events-none"
                ></div>
              </div>
            </div>
            <input
              id="volume-control"
              type="range"
              min="0"
              max="1"
              step="0.01"
              value="0.1"
              class="w-[calc(var(--app-height)_*_0.1)] lg:mt-4 bg-[#333] cursor-pointer z-1 hidden lg:block"
            />
          </div>
        </div>
      </div>
    </div>

    <script type="module" src="/src/main.js"></script>
    <script>
      function setAppHeight() {
        const doc = document.documentElement;
        const height = window.innerHeight;
        doc.style.setProperty('--app-height', `${height}px`);
      }

      // Only run once on load
      window.addEventListener('DOMContentLoaded', setAppHeight);
      window.addEventListener('orientationchange', setAppHeight);

      // Debounce resize to avoid layout jank from address bar toggling
      let lastHeight = window.innerHeight;
      window.addEventListener('resize', () => {
        const currentHeight = window.innerHeight;
        if (Math.abs(currentHeight - lastHeight) > 100) {
          setAppHeight();
          lastHeight = currentHeight;
        }
      });
    </script>
  </body>
</html>
